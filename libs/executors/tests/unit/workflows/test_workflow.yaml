writer_section: &writer_defaults
  writer: console
  writer_parameters:
    format: json
common_context: &empty_context
  context:
    query_parameters:
      macro: {}
      template: {}
fetcher_section: &fetcher_defaults
    fetcher_parameters:
      data:
        - resource: Campaign A
          dimensions:
            name: Ad Group 1
            id: 101
          metrics:
            clicks: 1500
            cost: 250.75
        - resource: Campaign B
          dimensions:
            name: Ad Group 2
            id: 102
          metrics:
            clicks: 2300
            cost: 410.20
        - resource: Campaign C
          dimensions:
            name: Ad Group 3
            id: 103
          metrics:
            clicks: 800
            cost: 120.50
        - resource: Campaign A
          dimensions:
            name: Ad Group 4
            id: 104
          metrics:
            clicks: 3200
            cost: 600.00

steps:
  - alias: test
    fetcher: fake
    queries:
      - query:
          title: test_query
          text:  |
            SELECT
              resource,
              dimensions.name AS name,
              metrics.clicks AS clicks
            FROM resource
    <<: [*empty_context, *writer_defaults, *fetcher_defaults]
  - alias: test_parametrized
    fetcher: fake
    garf:
      row: row
      report: gquery:sqldb:SELECT 'name1' AS name UNION ALL SELECT 'name2' AS name;
    queries:
      - query:
          title: test_query
          text:  |
            SELECT
              resource,
              dimensions.name AS  {row.name},
              metrics.clicks AS clicks
            FROM resource
    <<: [*empty_context, *writer_defaults, *fetcher_defaults]
